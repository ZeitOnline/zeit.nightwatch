name: Testrunner

on:
  push:
    branches:
    - main
  pull_request:

jobs:
  test:
    name: Test Run
    runs-on: [self-hosted,linux]
    permissions:
      contents: read
      checks: write

    steps:
    - uses: actions/checkout@v3
    - uses: actions/setup-python@v4
    - run: python -m pip install --upgrade tox

    - run: python -m tox -- --junitxml=report.xml -o junit_family=xunit2

    - name: Publish test result
      uses: enricomi/publish-unit-test-result-action@v2
      if: always()
      with:
        junit_files: report.xml
        comment_mode: "off"
